From 908ff9181d01333e9ad0c7d6a34084521a5e4883 Mon Sep 17 00:00:00 2001
From: Nanhumly <admin@warbler.cc>
Date: Mon, 9 Oct 2023 17:20:14 +0000
Subject: [PATCH] [HACK] Don't create vendor/etc/linker.config.pb with
 STUB_LIBRARIES

Change-Id: I39859874ae7d184f5e0907927266c3100b9ec377
Signed-off-by: Nanhumly <admin@warbler.cc>
---
 core/Makefile | 16 ----------------
 1 file changed, 16 deletions(-)

diff --git a/core/Makefile b/core/Makefile
index 9c910afd71..e578c114b1 100644
--- a/core/Makefile
+++ b/core/Makefile
@@ -3594,22 +3594,6 @@ ifdef BOARD_USES_VENDOR_DLKMIMAGE
   ALL_DEFAULT_INSTALLED_MODULES += $(_vendor_dlkm_lib_modules_symlink)
 endif
 
-# Install vendor/etc/linker.config.pb with PRODUCT_VENDOR_LINKER_CONFIG_FRAGMENTS and STUB_LIBRARIES
-vendor_linker_config_file := $(TARGET_OUT_VENDOR)/etc/linker.config.pb
-$(vendor_linker_config_file): private_linker_config_fragments := $(PRODUCT_VENDOR_LINKER_CONFIG_FRAGMENTS)
-$(vendor_linker_config_file): $(INTERNAL_VENDORIMAGE_FILES) $(PRODUCT_VENDOR_LINKER_CONFIG_FRAGMENTS) | $(HOST_OUT_EXECUTABLES)/conv_linker_config
-	@echo Creating linker config: $@
-	@mkdir -p $(dir $@)
-	@rm -f $@
-	$(HOST_OUT_EXECUTABLES)/conv_linker_config proto \
-		--source $(call normalize-path-list,$(private_linker_config_fragments)) \
-		--output $@
-	$(HOST_OUT_EXECUTABLES)/conv_linker_config systemprovide --source $@ \
-		--output $@ --value "$(STUB_LIBRARIES)" --system "$(TARGET_OUT_VENDOR)"
-$(call define declare-0p-target,$(vendor_linker_config_file),)
-INTERNAL_VENDORIMAGE_FILES += $(vendor_linker_config_file)
-ALL_DEFAULT_INSTALLED_MODULES += $(vendor_linker_config_file)
-
 INSTALLED_FILES_FILE_VENDOR := $(PRODUCT_OUT)/installed-files-vendor.txt
 INSTALLED_FILES_JSON_VENDOR := $(INSTALLED_FILES_FILE_VENDOR:.txt=.json)
 $(INSTALLED_FILES_FILE_VENDOR): .KATI_IMPLICIT_OUTPUTS := $(INSTALLED_FILES_JSON_VENDOR)
-- 
2.25.1

